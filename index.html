<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TABLE TO .ICS CONVERTER</title>
    <style>
        body {
            font-family: Helvetica, sans-serif;
            margin: 0;
            padding: 0;
            background-color: skyblue;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        #header {
            text-align: center;
            background-color: skyblue;
            padding: 10px 0;
        }

        #divider {
            width: 100%;
            border-top: 2px solid white;
            margin-top: 10px;
        }

        #content {
            padding: 20px;
        }

        #footer {
            background-color: grey;
            padding: 10px 0;
            text-align: center;
        }

        #footer a {
            text-decoration: none;
            color: skyblue;
            cursor: pointer;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        th, td {
            border: 1px solid white;
            padding: 10px;
            text-align: left;
        }

        td[contentEditable="true"]:focus {
            outline: 2px solid #0066cc;
        }

        .button-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .button-container-inline {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        button {
            flex: 1;
            margin: 5px;
            padding: 10px;
            cursor: pointer;
            background-color: #3498db;
            color: white;
            border: none;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #2980b9;
        }

        #fileEntry {
            width: 200px;
            padding: 5px;
            margin-bottom: 10px;
        }

        .tooltip {
            position: relative;
            display: inline-block;
            border-bottom: 1px dotted black;
            }

            .tooltip .tooltiptext {
            visibility: hidden;
            width: 300px;
            background-color: black;
            color: #fff;
            text-align: center;
            padding: 5px 0;
            border-radius: 6px;
            
            position: absolute;
            z-index: 1;
            }

            .tooltip:hover .tooltiptext {
            visibility: visible;
            }
    </style>
</head>
<body>

<div id="header">
    <h2>TABLE TO .ICS CONVERTER</h2>
</div>

<div id="divider"></div>

<div id="content">

<br>

<label>Select Timezone:</label>
<select id="timezoneOptions">
</select>

<br>

<label>Start Date:</label>
<input type="date" id="startDateCal">

<br>

<label>End Date:</label>
<input type="date" id="endDateCal" required>

<br>

<label>Repetition Check</label>
<div class="tooltip">??
    <span class="tooltiptext">08:30am - 09:00am : Subject 1<br>09:00am - 10:00am : Subject 1<br>->08:30am - 10:00am : Subject 1</span>
</div>
<input type="checkbox" id="repetitionCheck" checked>

<br>

</div>

<div id="divider"></div>

<br>

<div class="button-container-inline">
    <button onclick="saveChanges()">Save Changes</button>
    <button onclick="search()">Enter Presaved Data</button>
    <button onclick="copy()">Copy Saved Data</button>
    <button style="background-color: red;" onclick="clearTable()">Reset Data</button>
</div>

<div class="button-container">
    <!-- <button onclick="addRow()">Add Row ↓</button> -->
    <button onclick="addColumn()">Add Column →</button>
    <!-- <button onclick="removeRow()">Remove Row ↑</button> -->
    <button onclick="removeColumn()">Remove Column ←</button>
</div>

<div id="docx">
<div class="WordSection1">
<table id="myTable">
    <tr>
        <th><div class="tooltip">Day
            <span class="tooltiptext">Please enter the time period in this format: 8:30am - 10:00am (h:mm[am/pm] - h:mm[am/pm])</span>
        </div></th>
        <th contentEditable="true">8:30am – 9:20am</th>
        <th contentEditable="true">9:25am – 10:15am</th>
        <th contentEditable="true">10:30am – 11:20am</th>
        <th contentEditable="true">11:25am – 12:15pm</th>
        <th contentEditable="true">1:10pm – 2:00pm</th>
        <th contentEditable="true">2:05pm – 2:55pm</th>
        <th contentEditable="true">3:00pm – 3:50pm</th>
        <th contentEditable="true">3:55pm – 4:45pm</th>
    </tr>
    <tr>
        <td>Monday</td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
    </tr>
    <tr>
        <td contentEditable="false">Tuesday</td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
    </tr>
    <tr>
        <td contentEditable="false">Wednesday</td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
    </tr>
    <tr>
        <td contentEditable="false">Thursday</td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
    </tr>
    <tr>
        <td contentEditable="false">Friday</td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
    </tr>
    <tr>
        <td contentEditable="false">Saturday</td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
    </tr>
    <tr>
        <td contentEditable="false">Sunday</td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
        <td contentEditable="true"></td>
    </tr>
</table>
</div>
</div>

<div class="button-container">
    <button onclick="downloadICS()">Download ICS</button>
    <button  onclick="convertTableToDocx()">Download Word</button>
</div>


<div id="footer">
    <p>Made by <a href="https://github.com/shyaaaaaaam/Word-ICS_Calendar" target="_blank">shyaaaaaaam</a></p>
</div>

<script>
    window.onload = loadTableData;

    var saveAs=saveAs||function(e){"use strict";if(typeof e==="undefined"||typeof navigator!=="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent)){return}var t=e.document,n=function(){return e.URL||e.webkitURL||e},r=t.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in r,a=function(e){var t=new MouseEvent("click");e.dispatchEvent(t)},i=/constructor/i.test(e.HTMLElement)||e.safari,f=/CriOS\/[\d]+/.test(navigator.userAgent),u=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},s="application/octet-stream",d=1e3*40,c=function(e){var t=function(){if(typeof e==="string"){n().revokeObjectURL(e)}else{e.remove()}};setTimeout(t,d)},l=function(e,t,n){t=[].concat(t);var r=t.length;while(r--){var o=e["on"+t[r]];if(typeof o==="function"){try{o.call(e,n||e)}catch(a){u(a)}}}},p=function(e){if(/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)){return new Blob([String.fromCharCode(65279),e],{type:e.type})}return e},v=function(t,u,d){if(!d){t=p(t)}var v=this,w=t.type,m=w===s,y,h=function(){l(v,"writestart progress write writeend".split(" "))},S=function(){if((f||m&&i)&&e.FileReader){var r=new FileReader;r.onloadend=function(){var t=f?r.result:r.result.replace(/^data:[^;]*;/,"data:attachment/file;");var n=e.open(t,"_blank");if(!n)e.location.href=t;t=undefined;v.readyState=v.DONE;h()};r.readAsDataURL(t);v.readyState=v.INIT;return}if(!y){y=n().createObjectURL(t)}if(m){e.location.href=y}else{var o=e.open(y,"_blank");if(!o){e.location.href=y}}v.readyState=v.DONE;h();c(y)};v.readyState=v.INIT;if(o){y=n().createObjectURL(t);setTimeout(function(){r.href=y;r.download=u;a(r);h();c(y);v.readyState=v.DONE});return}S()},w=v.prototype,m=function(e,t,n){return new v(e,t||e.name||"download",n)};if(typeof navigator!=="undefined"&&navigator.msSaveOrOpenBlob){return function(e,t,n){t=t||e.name||"download";if(!n){e=p(e)}return navigator.msSaveOrOpenBlob(e,t)}}w.abort=function(){};w.readyState=w.INIT=0;w.WRITING=1;w.DONE=2;w.error=w.onwritestart=w.onprogress=w.onwrite=w.onabort=w.onerror=w.onwriteend=null;return m}(typeof self!=="undefined"&&self||typeof window!=="undefined"&&window||this.content);if(typeof module!=="undefined"&&module.exports){module.exports.saveAs=saveAs}else if(typeof define!=="undefined"&&define!==null&&define.amd!==null){define("FileSaver.js",function(){return saveAs})};
    var ics=function(e,t){"use strict";{if(!(navigator.userAgent.indexOf("MSIE")>-1&&-1==navigator.userAgent.indexOf("MSIE 10"))){void 0===e&&(e="default"),void 0===t&&(t="Calendar");var r=-1!==navigator.appVersion.indexOf("Win")?"\r\n":"\n",n=[],i=["BEGIN:VCALENDAR","PRODID:"+t,"VERSION:2.0"].join(r),o=r+"END:VCALENDAR",a=["SU","MO","TU","WE","TH","FR","SA"];return{events:function(){return n},calendar:function(){return i+r+n.join(r)+o},addEvent:function(t,i,o,l,u,s){if(void 0===t||void 0===i||void 0===o||void 0===l||void 0===u)return!1;if(s&&!s.rrule){if("YEARLY"!==s.freq&&"MONTHLY"!==s.freq&&"WEEKLY"!==s.freq&&"DAILY"!==s.freq)throw"Recurrence rrule frequency must be provided and be one of the following: 'YEARLY', 'MONTHLY', 'WEEKLY', or 'DAILY'";if(s.until&&isNaN(Date.parse(s.until)))throw"Recurrence rrule 'until' must be a valid date string";if(s.interval&&isNaN(parseInt(s.interval)))throw"Recurrence rrule 'interval' must be an integer";if(s.count&&isNaN(parseInt(s.count)))throw"Recurrence rrule 'count' must be an integer";if(void 0!==s.byday){if("[object Array]"!==Object.prototype.toString.call(s.byday))throw"Recurrence rrule 'byday' must be an array";if(s.byday.length>7)throw"Recurrence rrule 'byday' array must not be longer than the 7 days in a week";s.byday=s.byday.filter(function(e,t){return s.byday.indexOf(e)==t});for(var c in s.byday)if(a.indexOf(s.byday[c])<0)throw"Recurrence rrule 'byday' values must include only the following: 'SU', 'MO', 'TU', 'WE', 'TH', 'FR', 'SA'"}}var g=new Date(l),d=new Date(u),f=new Date,S=("0000"+g.getFullYear().toString()).slice(-4),E=("00"+(g.getMonth()+1).toString()).slice(-2),v=("00"+g.getDate().toString()).slice(-2),y=("00"+g.getHours().toString()).slice(-2),A=("00"+g.getMinutes().toString()).slice(-2),T=("00"+g.getSeconds().toString()).slice(-2),b=("0000"+d.getFullYear().toString()).slice(-4),D=("00"+(d.getMonth()+1).toString()).slice(-2),N=("00"+d.getDate().toString()).slice(-2),h=("00"+d.getHours().toString()).slice(-2),I=("00"+d.getMinutes().toString()).slice(-2),R=("00"+d.getMinutes().toString()).slice(-2),M=("0000"+f.getFullYear().toString()).slice(-4),w=("00"+(f.getMonth()+1).toString()).slice(-2),L=("00"+f.getDate().toString()).slice(-2),O=("00"+f.getHours().toString()).slice(-2),p=("00"+f.getMinutes().toString()).slice(-2),Y=("00"+f.getMinutes().toString()).slice(-2),U="",V="";y+A+T+h+I+R!=0&&(U="T"+y+A+T,V="T"+h+I+R);var B,C=S+E+v+U,j=b+D+N+V,m=M+w+L+("T"+O+p+Y);if(s)if(s.rrule)B=s.rrule;else{if(B="rrule:FREQ="+s.freq,s.until){var x=new Date(Date.parse(s.until)).toISOString();B+=";UNTIL="+x.substring(0,x.length-13).replace(/[-]/g,"")+"000000Z"}s.interval&&(B+=";INTERVAL="+s.interval),s.count&&(B+=";COUNT="+s.count),s.byday&&s.byday.length>0&&(B+=";BYDAY="+s.byday.join(","))}(new Date).toISOString();var H=["BEGIN:VEVENT","UID:"+n.length+"@"+e,"CLASS:PUBLIC","DESCRIPTION:"+i,"DTSTAMP;VALUE=DATE-TIME:"+m,"DTSTART;VALUE=DATE-TIME:"+C,"DTEND;VALUE=DATE-TIME:"+j,"LOCATION:"+o,"SUMMARY;LANGUAGE=en-us:"+t,"TRANSP:TRANSPARENT","END:VEVENT"];return B&&H.splice(4,0,B),H=H.join(r),n.push(H),H},download:function(e,t){if(n.length<1)return!1;t=void 0!==t?t:".ics",e=void 0!==e?e:"calendar";var a,l=i+r+n.join(r)+o;if(-1===navigator.userAgent.indexOf("MSIE 10"))a=new Blob([l]);else{var u=new BlobBuilder;u.append(l),a=u.getBlob("text/x-vCalendar;charset="+document.characterSet)}return saveAs(a,e+t),l},build:function(){return!(n.length<1)&&i+r+n.join(r)+o}}}console.log("Unsupported Browser")}};

    function convertTableToDocx() {
        if (!window.Blob) {
            alert('Your legacy browser does not support this action.');
            return;
        }

        var html, link, blob, url, css;
        
        css = (
            '<style>' +
            '@page WordSection1{size: 841.95pt 595.35pt;mso-page-orientation: landscape;}' +
            'div.WordSection1 {page: WordSection1;}' +
            'table{border-collapse:collapse;}td{border:1px gray solid;width:5em;padding:2px;}'+
            '</style>'
        );
        
        html = window.docx.innerHTML;
        blob = new Blob(['\ufeff', css + html], {
            type: 'application/msword'
        });
        url = URL.createObjectURL(blob);
        link = document.createElement('A');
        link.href = url;
        link.download = 'Document';   
        document.body.appendChild(link);
        if (navigator.msSaveOrOpenBlob ) navigator.msSaveOrOpenBlob( blob, 'Document.doc');
                else link.click();
        document.body.removeChild(link);
    }

    function search() {
        var input = prompt("Enter The Code: ");
        if (input === "") {
            alert("Invalid Data!");
        } else if (input === null) {

        } else {
            try {
                var data = JSON.parse(input);
                if (typeof(data) === "object") {
                    console.log(data);
                    var table = document.getElementById("myTable");

                    while (table.rows[0].cells.length > 1) {
                        removeColumn();
                    }
                    for (var i = 1; i < data[0].length; i++) {
                        addColumn();
                        for (var j = 0; j < data.length; j++) {
                            var cell = table.rows[j].cells[i];
                            cell.innerHTML = data[j][i];
                            cell.setAttribute("contentEditable", "true");
                        }
                    }
                    alert("Loaded Data! Don't Forget To Save!");
                } else {
                    alert("Invalid Data!");
                }
            } catch {
                alert("Invalid Data!");
            } 
        }
    }

    function copy() {
        var cookieString = document.cookie;
        var cookieName = 'tableData'; 
        var cookies = cookieString.split(';');

        var flag = false;

        for (var i = 0; i < cookies.length; i++) {
            var cookie = cookies[i].trim();
            var cookieParts = cookie.split('=');

            if (cookieParts.length === 2) {
                var name = cookieParts[0].trim();
                var value = cookieParts[1].trim();

                if (name === cookieName) {
                    flag = true;
                    navigator.clipboard.writeText(value);
                    alert("Data Copied To Clipboard:\n\n" + value);
                }
            }
        }
        
        if (flag === false) {
            alert("No Data Found!");
        }
        
    }

    function formatDate(inputString) {
        var parts = inputString.split("-");
        var formattedDate = parts[1] + "/" + parts[2] + "/" + parts[0];
        return formattedDate;
    }

    function convertDateFormat(inputDate) {
        return inputDate.replace(/-/g, '');
    }

    function addDays(dateString, numberOfDays) {
        var currentDate = new Date(dateString);
        currentDate.setDate(currentDate.getDate() + numberOfDays);
        var formattedDate = (currentDate.getMonth() + 1).toString().padStart(2, '0') + '/' + (currentDate.getDate()).toString().padStart(2, '0') + '/' + currentDate.getFullYear();
        return formattedDate;
    }

    function findAllConsecutiveStrings(arr) {
        let result = [];
        let startIdx = -1;

        for (let i = 0; i < arr.length; i++) {
            if (arr[i] === arr[i + 1]) {
                if (startIdx === -1) {
                    startIdx = i;
                }
            } else {
                if (startIdx !== -1) {
                    result.push({ start: startIdx, end: i });
                    startIdx = -1;
                } else {
                    result.push({ start: i, end: i });
                }
            }
        }

        return result;
    }

    function rewindToMonday(inputDate) {
        var isDashFormat = inputDate.indexOf("-") !== -1;
        var parts = isDashFormat ? inputDate.split('-') : inputDate.split('/');
        var day = parseInt(parts[isDashFormat ? 2 : 0], 10);
        var month = parseInt(parts[isDashFormat ? 1 : 1], 10) - 1;
        var year = parseInt(parts[isDashFormat ? 0 : 2], 10);
        var date = new Date(year, month, day);
        var dayOfWeek = date.getDay();
        if (dayOfWeek !== 1) {
            var daysToRewind = dayOfWeek === 0 ? 6 : dayOfWeek - 1;
            date.setDate(date.getDate() - daysToRewind);
        }
        var formattedDate = date.getFullYear() + '-' + (date.getMonth() + 1).toString().padStart(2, '0') + '-' + date.getDate().toString().padStart(2, '0');
        return formattedDate;
    }

    function downloadICS() {
        var cal = ics();
        var table = document.getElementById("myTable");
        var timelist = [];
        var dayLists = {
            Monday: [],
            Tuesday: [],
            Wednesday: [],
            Thursday: [],
            Friday: [],
            Saturday: [],
            Sunday: []
        };

        for (var i = 1; i < table.rows[0].cells.length; i++) {
            timelist.push(table.rows[0].cells[i].innerText);
        }

        for (var i = 1; i < table.rows.length; i++) {
            var day = table.rows[i].cells[0].innerText;
            for (var j = 1; j < table.rows[i].cells.length; j++) {
                dayLists[day].push(table.rows[i].cells[j].innerText);
            }
        }

        console.log("Time List:", timelist);
        console.log("Day Lists:", dayLists);
        var calstartdate = document.getElementById("startDateCal").value;
        var startdate = rewindToMonday(calstartdate);
        var enddate = document.getElementById("endDateCal").value;

        if (document.getElementById('repetitionCheck').checked) {
            var i = 0;
            for (var day in dayLists) {
                var consecutives = findAllConsecutiveStrings(dayLists[day]);
                for (var j = 0; j < consecutives.length; j++) {
                    var start = consecutives[j]["start"];
                    var stop = consecutives[j]["end"];
                    if (start == stop) {
                        if (dayLists[day][start] === '') {

                        } else {
                            var myArray = timelist[start].split(" ");
                            var startdt = addDays(formatDate(startdate.toString()), i) + " " + myArray[0].replace(/(\d{1,2}:\d{2})([APMapm]{2})/, '$1 $2');
                            var enddt = addDays(formatDate(startdate.toString()), i) + " " + myArray[2].replace(/(\d{1,2}:\d{2})([APMapm]{2})/, '$1 $2');
                            cal.addEvent(dayLists[day][start], dayLists[day][start], '', startdt, enddt, {freq: 'WEEKLY', until: new Date(enddate), byday: [(day.substring(0, 2)).toUpperCase()], interval: 1});
                        }
                    } else {
                        if (dayLists[day][start] === '') {

                        } else {
                            var myArraystart = timelist[start].split(" ");
                            var myArraystop = timelist[stop].split(" ");
                            var startdt = addDays(formatDate(startdate.toString()), i) + " " + myArraystart[0].replace(/(\d{1,2}:\d{2})([APMapm]{2})/, '$1 $2');
                            var enddt = addDays(formatDate(startdate.toString()), i) + " " + myArraystop[2].replace(/(\d{1,2}:\d{2})([APMapm]{2})/, '$1 $2');
                            cal.addEvent(dayLists[day][start], dayLists[day][start], '', startdt, enddt, {freq: 'WEEKLY', until: new Date(enddate), byday: [(day.substring(0, 2)).toUpperCase()], interval: 1});
                        }
                    }
                }
                i++;
            }
            cal.download("my_ics");
        } else {
            var i = 0;
            for (var day in dayLists) {
                for (var j = 0; j < timelist.length; j++) {
                    if (dayLists[day][j] === '') {

                    } else {
                        var myArray = timelist[j].split(" ");
                        var startdt = addDays(formatDate(startdate.toString()), i) + " " + myArray[0].replace(/(\d{1,2}:\d{2})([APMapm]{2})/, '$1 $2');
                        var enddt = addDays(formatDate(startdate.toString()), i) + " " + myArray[2].replace(/(\d{1,2}:\d{2})([APMapm]{2})/, '$1 $2');
                        cal.addEvent(dayLists[day][j], dayLists[day][j], '', startdt, enddt, {freq: 'WEEKLY', until: new Date(enddate), byday: [(day.substring(0, 2)).toUpperCase()], interval: 1});
                    }
                }
                i++;
            }
            cal.download("my_ics");
        }
    }

    function saveChanges() {
        var table = document.getElementById("myTable");
        var data = [];

        for (var i = 0; i < table.rows.length; i++) {
            var rowData = [];
            for (var j = 0; j < table.rows[i].cells.length; j++) {
                rowData.push(table.rows[i].cells[j].innerText);
            }
            data.push(rowData);
        }

        var jsonData = JSON.stringify(data);

        document.cookie = "tableData=" + jsonData;

        console.log("Table Data:", data);
    }

    function loadTableData() {
        var cookieData = document.cookie.replace(/(?:(?:^|.*;\s*)tableData\s*=\s*([^;]*).*$)|^.*$/, "$1");
        if (cookieData) {
            var data = JSON.parse(cookieData);

            var table = document.getElementById("myTable");

            while (table.rows[0].cells.length > 1) {
                removeColumn();
            }
            console.log(data);
            for (var i = 1; i < data[0].length; i++) {
                addColumn();
                for (var j = 0; j < data.length; j++) {
                    var cell = table.rows[j].cells[i];
                    cell.innerHTML = data[j][i];
                    cell.setAttribute("contentEditable", "true");
                }
            }
        }
    }

    function clearTable() {
        var reply = confirm("Are You Sure? This Will Reset All Data Changes!");
        if (reply == true) {
            document.cookie = 'tableData=; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';
            location.reload();
        } else {}
    }

    function addRow() {
        var table = document.getElementById("myTable");
        var newRow = table.insertRow(table.rows.length);
        for (var i = 0; i < table.rows[0].cells.length; i++) {
            var cell = newRow.insertCell(i);
            cell.innerHTML = "";
            cell.setAttribute("contentEditable", "true");
        }
    }

    function addColumn() {
        var table = document.getElementById("myTable");
        for (var i = 0; i < table.rows.length; i++) {
            var cell = table.rows[i].insertCell(table.rows[i].cells.length);
            cell.innerHTML = "";
            cell.setAttribute("contentEditable", "true");
        }
    }

    function removeRow() {
        var table = document.getElementById("myTable");
        if (table.rows.length > 1) {
            table.deleteRow(table.rows.length - 1);
        }
    }

    function removeColumn() {
        var table = document.getElementById("myTable");
        if (table.rows[0].cells.length > 1) {
            for (var i = 0; i < table.rows.length; i++) {
                table.rows[i].deleteCell(table.rows[i].cells.length - 1);
            }
        }
    }

    var timezones_list = [
        {
            "offset": "GMT-12:00",
            "name": "Etc/GMT-12"
        },
        {
            "offset": "GMT-11:00",
            "name": "Etc/GMT-11"
        },
        {
            "offset": "GMT-11:00",
            "name": "Pacific/Midway"
        },
        {
            "offset": "GMT-10:00",
            "name": "America/Adak"
        },
        {
            "offset": "GMT-09:00",
            "name": "America/Anchorage"
        },
        {
            "offset": "GMT-09:00",
            "name": "Pacific/Gambier"
        },
        {
            "offset": "GMT-08:00",
            "name": "America/Dawson_Creek"
        },
        {
            "offset": "GMT-08:00",
            "name": "America/Ensenada"
        },
        {
            "offset": "GMT-08:00",
            "name": "America/Los_Angeles"
        },
        {
            "offset": "GMT-07:00",
            "name": "America/Chihuahua"
        },
        {
            "offset": "GMT-07:00",
            "name": "America/Denver"
        },
        {
            "offset": "GMT-06:00",
            "name": "America/Belize"
        },
        {
            "offset": "GMT-06:00",
            "name": "America/Cancun"
        },
        {
            "offset": "GMT-06:00",
            "name": "America/Chicago"
        },
        {
            "offset": "GMT-06:00",
            "name": "Chile/EasterIsland"
        },
        {
            "offset": "GMT-05:00",
            "name": "America/Bogota"
        },
        {
            "offset": "GMT-05:00",
            "name": "America/Havana"
        },
        {
            "offset": "GMT-05:00",
            "name": "America/New_York"
        },
        {
            "offset": "GMT-04:30",
            "name": "America/Caracas"
        },
        {
            "offset": "GMT-04:00",
            "name": "America/Campo_Grande"
        },
        {
            "offset": "GMT-04:00",
            "name": "America/Glace_Bay"
        },
        {
            "offset": "GMT-04:00",
            "name": "America/Goose_Bay"
        },
        {
            "offset": "GMT-04:00",
            "name": "America/Santiago"
        },
        {
            "offset": "GMT-04:00",
            "name": "America/La_Paz"
        },
        {
            "offset": "GMT-03:00",
            "name": "America/Argentina/Buenos_Aires"
        },
        {
            "offset": "GMT-03:00",
            "name": "America/Montevideo"
        },
        {
            "offset": "GMT-03:00",
            "name": "America/Araguaina"
        },
        {
            "offset": "GMT-03:00",
            "name": "America/Godthab"
        },
        {
            "offset": "GMT-03:00",
            "name": "America/Miquelon"
        },
        {
            "offset": "GMT-03:00",
            "name": "America/Sao_Paulo"
        },
        {
            "offset": "GMT-03:30",
            "name": "America/St_Johns"
        },
        {
            "offset": "GMT-02:00",
            "name": "America/Noronha"
        },
        {
            "offset": "GMT-01:00",
            "name": "Atlantic/Cape_Verde"
        },
        {
            "offset": "GMT",
            "name": "Europe/Belfast"
        },
        {
            "offset": "GMT",
            "name": "Africa/Abidjan"
        },
        {
            "offset": "GMT",
            "name": "Europe/Dublin"
        },
        {
            "offset": "GMT",
            "name": "Europe/Lisbon"
        },
        {
            "offset": "GMT",
            "name": "Europe/London"
        },
        {
            "offset": "UTC",
            "name": "UTC"
        },
        {
            "offset": "GMT+01:00",
            "name": "Africa/Algiers"
        },
        {
            "offset": "GMT+01:00",
            "name": "Africa/Windhoek"
        },
        {
            "offset": "GMT+01:00",
            "name": "Atlantic/Azores"
        },
        {
            "offset": "GMT+01:00",
            "name": "Atlantic/Stanley"
        },
        {
            "offset": "GMT+01:00",
            "name": "Europe/Amsterdam"
        },
        {
            "offset": "GMT+01:00",
            "name": "Europe/Belgrade"
        },
        {
            "offset": "GMT+01:00",
            "name": "Europe/Brussels"
        },
        {
            "offset": "GMT+02:00",
            "name": "Africa/Cairo"
        },
        {
            "offset": "GMT+02:00",
            "name": "Africa/Blantyre"
        },
        {
            "offset": "GMT+02:00",
            "name": "Asia/Beirut"
        },
        {
            "offset": "GMT+02:00",
            "name": "Asia/Damascus"
        },
        {
            "offset": "GMT+02:00",
            "name": "Asia/Gaza"
        },
        {
            "offset": "GMT+02:00",
            "name": "Asia/Jerusalem"
        },
        {
            "offset": "GMT+03:00",
            "name": "Africa/Addis_Ababa"
        },
        {
            "offset": "GMT+03:00",
            "name": "Asia/Riyadh89"
        },
        {
            "offset": "GMT+03:00",
            "name": "Europe/Minsk"
        },
        {
            "offset": "GMT+03:30",
            "name": "Asia/Tehran"
        },
        {
            "offset": "GMT+04:00",
            "name": "Asia/Dubai"
        },
        {
            "offset": "GMT+04:00",
            "name": "Asia/Yerevan"
        },
        {
            "offset": "GMT+04:00",
            "name": "Europe/Moscow"
        },
        {
            "offset": "GMT+04:30",
            "name": "Asia/Kabul"
        },
        {
            "offset": "GMT+05:00",
            "name": "Asia/Tashkent"
        },
        {
            "offset": "GMT+05:30",
            "name": "Asia/Kolkata"
        },
        {
            "offset": "GMT+05:45",
            "name": "Asia/Katmandu"
        },
        {
            "offset": "GMT+06:00",
            "name": "Asia/Dhaka"
        },
        {
            "offset": "GMT+06:00",
            "name": "Asia/Yekaterinburg"
        },
        {
            "offset": "GMT+06:30",
            "name": "Asia/Rangoon"
        },
        {
            "offset": "GMT+07:00",
            "name": "Asia/Bangkok"
        },
        {
            "offset": "GMT+07:00",
            "name": "Asia/Novosibirsk"
        },
        {
            "offset": "GMT+08:00",
            "name": "Etc/GMT+8"
        },
        {
            "offset": "GMT+08:00",
            "name": "Asia/Hong_Kong"
        },
        {
            "offset": "GMT+08:00",
            "name": "Asia/Krasnoyarsk"
        },
        {
            "offset": "GMT+08:00",
            "name": "Australia/Perth"
        },
        {
            "offset": "GMT+08:45",
            "name": "Australia/Eucla"
        },
        {
            "offset": "GMT+09:00",
            "name": "Asia/Irkutsk"
        },
        {
            "offset": "GMT+09:00",
            "name": "Asia/Seoul"
        },
        {
            "offset": "GMT+09:00",
            "name": "Asia/Tokyo"
        },
        {
            "offset": "GMT+09:30",
            "name": "Australia/Adelaide"
        },
        {
            "offset": "GMT+09:30",
            "name": "Australia/Darwin"
        },
        {
            "offset": "GMT+09:30",
            "name": "Pacific/Marquesas"
        },
        {
            "offset": "GMT+10:00",
            "name": "Etc/GMT+10"
        },
        {
            "offset": "GMT+10:00",
            "name": "Australia/Brisbane"
        },
        {
            "offset": "GMT+10:00",
            "name": "Australia/Hobart"
        },
        {
            "offset": "GMT+10:00",
            "name": "Asia/Yakutsk"
        },
        {
            "offset": "GMT+10:30",
            "name": "Australia/Lord_Howe"
        },
        {
            "offset": "GMT+11:00",
            "name": "Asia/Vladivostok"
        },
        {
            "offset": "GMT+11:30",
            "name": "Pacific/Norfolk"
        },
        {
            "offset": "GMT+12:00",
            "name": "Etc/GMT+12"
        },
        {
            "offset": "GMT+12:00",
            "name": "Asia/Anadyr"
        },
        {
            "offset": "GMT+12:00",
            "name": "Asia/Magadan"
        },
        {
            "offset": "GMT+12:00",
            "name": "Pacific/Auckland"
        },
        {
            "offset": "GMT+12:45",
            "name": "Pacific/Chatham"
        },
        {
            "offset": "GMT+13:00",
            "name": "Pacific/Tongatapu"
        },
        {
            "offset": "GMT+14:00",
            "name": "Pacific/Kiritimati"
        }
    ]

    function populateTimezones() {
        var x = document.getElementById("timezoneOptions");
        for (var i = 0; i < timezones_list.length; i++) {
            var option = document.createElement("option");
            option.text = timezones_list[i]["name"];
            option.value = timezones_list[i]["offset"];
            x.add(option);
            if (timezones_list[i]["name"] === "Asia/Kolkata") {
                option.selected = true;
            }
        }
    }

    populateTimezones();
    var date = new Date()
    document.getElementById('startDateCal').valueAsDate = date;
    document.getElementById('endDateCal').valueAsDate = new Date(date.getTime() + 1000 * 60 * 60 * 24 * 7);;
</script>

</body>
</html>
